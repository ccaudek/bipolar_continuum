<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>apx_rev1_idionomic</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="apx_rev1_idionomic_files/libs/clipboard/clipboard.min.js"></script>
<script src="apx_rev1_idionomic_files/libs/quarto-html/quarto.js"></script>
<script src="apx_rev1_idionomic_files/libs/quarto-html/popper.min.js"></script>
<script src="apx_rev1_idionomic_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="apx_rev1_idionomic_files/libs/quarto-html/anchor.min.js"></script>
<link href="apx_rev1_idionomic_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="apx_rev1_idionomic_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="apx_rev1_idionomic_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="apx_rev1_idionomic_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="apx_rev1_idionomic_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<p>The analyses described in the previous section provided evidence supporting the “essential unidimensionality” <span class="citation" data-cites="reise2013scoring">[@reise2013scoring]</span> of state self-compassion. Our multilevel framework, which accounted for repeated measurements within individuals over a three-month period, demonstrated that compassionate and uncompassionate self-responding (CS and UCS) are inversely related at the <em>nomothetic level</em> – that is, when examined across the entire sample.</p>
<p>Our psychometric evaluations, using purely <em>internal criteria</em> (fit indices for item scores), revealed that more complex models improved statistical fit. However, these improvements do not fundamentally challenge Neff’s hypothesis of a bipolar continuum. While minor deviations and better fit indices were observed with more complex models, their practical importance was limited, and the overall pattern of findings remained aligned with the notion of CS and UCS as opposing dimensions.</p>
<p>This conclusion is further corroborated when considering <em>external criteria</em>, including covariates such as momentary negative affect and context evaluation, as described in our two studies. These situational factors did not substantially disrupt the core relationship between CS and UCS proposed by the bipolar continuum hypothesis.</p>
<p>It is important to note, however, that all these previous analyses were conducted at a <em>nomothetic</em> level, focusing on group-level patterns. This approach, while valuable, may obscure important differences in how self-compassion operates in the everyday life of individuals. The variability in how individuals experience and express self-compassion across different contexts might not be fully captured in these broad, averaged analyses.</p>
<p>To address this limitation and gain deeper insights into person-specific dynamics, we conducted an <em>idionomic analysis</em> to examine the relationship between UCS and CS at the individual level <span class="citation" data-cites="ciarrochi2024compassion ferrari2022embracing sahdra2024testing">[@ciarrochi2024compassion; @ferrari2022embracing; @sahdra2024testing]</span>. This approach allows us to explore potential heterogeneity in self-compassion processes that may be masked by nomothetic analyses, providing a more nuanced understanding of how the CS and UCS constructs interact within individuals over time.</p>
<section id="idionomic-analysis-of-the-relationship-between-ucs-and-cs" class="level2">
<h2 class="anchored" data-anchor-id="idionomic-analysis-of-the-relationship-between-ucs-and-cs">Idionomic Analysis of the Relationship Between UCS and CS</h2>
<p>For the present purposes, an idionomic analysis was conducted in two stages. The first stage involved a strictly idiographic approach, focusing on the individual-level patterns. In the second stage, we applied a nomothetic approach to examine and describe group-level regularities as well as the variability in these effects across individuals <span class="citation" data-cites="ciarrochi2024compassion sahdra2024testing">[e.g., @ciarrochi2024compassion; @sahdra2024testing]</span>.</p>
<p><strong>Step 1: Fitting Individual-Level Hierarchical Bayesian Models.</strong> For each participant separatedly, we implemented a hierarchical Bayesian model using Stan to estimate the relationship between UCS and CS. The model incorporated additional covariates, including negative affect and context evaluation, as well as lagged effects of CS from the previous measurement within the same day. The model for each participant was specified as follows:</p>
<p><span class="math display">\[
\begin{aligned}
\text{UCS}_n \sim t_{\nu}\Big( &amp; \alpha + \gamma_{\text{CS}} \cdot \text{CS}_n + \gamma_{\text{neg\_aff}} \cdot \text{neg\_aff}_n \\
&amp; + \gamma_{\text{context}} \cdot \text{context}_n + \phi \cdot \text{lag\_CS}_n \\
&amp; + \gamma_{\text{interaction}} \cdot \text{CS}_n \cdot \text{neg\_aff}_n, \sigma \Big),
\end{aligned}
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\text{UCS}_n\)</span> represents the CS score for observation <span class="math inline">\(n\)</span>,</li>
<li><span class="math inline">\(\alpha\)</span> denotes the intercept,</li>
<li><span class="math inline">\(\gamma_{\text{CS}}\)</span> is the coefficient for the primary predictor, CS (<span class="math inline">\(\text{CS}_n\)</span>),</li>
<li><span class="math inline">\(\gamma_{\text{neg\_aff}}\)</span> and <span class="math inline">\(\gamma_{\text{context}}\)</span> are coefficients for negative affect (<span class="math inline">\(\text{neg\_aff}_n\)</span>) and context evaluation (<span class="math inline">\(\text{context}_n\)</span>), respectively,</li>
<li><span class="math inline">\(\phi\)</span> represents the autoregressive coefficient for the lagged CS within the same day (<span class="math inline">\(\text{lag\_CS}_n\)</span>),</li>
<li><span class="math inline">\(\sigma\)</span> is the scale parameter (standard deviation) of the distribution,</li>
<li><span class="math inline">\(\nu\)</span> denotes the degrees of freedom of the Student’s t-distribution,</li>
<li><span class="math inline">\(\gamma_{\text{interaction}}\)</span> is the coefficient for the interaction term between CS and negative affect.</li>
</ul>
<p>This model allows for the examination of the association between UCS and CS while controlling for the effects of negative affect, context evaluation, lagged CS effects within the same day, and the CS <span class="math inline">\(\times\)</span> negative-affect interaction. We employed a Student’s t-distribution (<span class="math inline">\(t_{\nu}\)</span>) to account for potential outliers or heavy-tailed distributions in the data.</p>
<p>For each participant, we examined the posterior distribution of the <code>gamma_CS</code> coefficient to estimate the proportion of posterior draws that were negative. This enabled us to evaluate whether there was evidence of a negative association between UCS and CS at the individual level, in line with Neff’s bipolar continuum hypothesis. Additionally, we computed the mean posterior estimates for the <code>gamma_neg_aff</code>, <code>gamma_context</code>, and <code>gamma_interaction</code> parameters, which represent the effects of negative affect, context evaluation, and the interaction between CS and negative affect, respectively, on UCS for each participant.</p>
<p><strong>Step 2: Aggregate Analysis Using a Hierarchical Model.</strong> After the idiographic analysis, we used a hierarchical model <span class="citation" data-cites="ciarrochi2024compassion">[e.g., @ciarrochi2024compassion]</span> in the <code>brms</code> package (R) to summarize the proportion of negative estimates for the <code>gamma_CS</code> parameter across participants. This model employed a binomial distribution, with the total number of posterior samples as the denominator and the proportion of negative estimates as the response. A random intercept for participants was included to account for individual variability.</p>
<p>Hierarchical models were also applied to the mean posterior estimates of the <code>gamma_neg_aff</code>, <code>gamma_context</code>, and <code>gamma_interaction</code> parameters, representing the influences of negative affect, context evaluation, and the interaction between CS and negative affect on UCS. Each model included a fixed effect (intercept) and random intercepts for participants, capturing individual differences. A Student-t likelihood was used to account for potential outliers and accommodate the heavy-tailed nature of the effect distributions, providing robust aggregate estimates of each parameter and the heterogeneity of their relationships with UCS.</p>
<section id="results" class="level3">
<h3 class="anchored" data-anchor-id="results">Results</h3>
<p>The analysis of the <code>gamma_CS</code> parameter across participants indicated that 81.0% (89% CI [0.796, 0.823]) of the posterior estimates for the association between uncompassionate self-responding (UCS) and compassionate self-responding (CS) were negative. This supports Neff’s bipolar continuum hypothesis, which posits an inverse relationship between UCS and CS. However, the variability in individual effects (<code>sd(Intercept)</code> = 1.25, corresponding to 0.196 on the probability scale) suggests moderate heterogeneity in the strength of this relationship across participants.</p>
<p>For the influence of negative affect on UCS, represented by the <code>gamma_neg_aff</code> parameter, the analysis revealed a positive overall effect (intercept = 0.38, 89% CI [0.34, 0.42]), indicating that higher levels of negative affect are generally associated with increased UCS. The variability between individuals (<code>sd(Intercept)</code> = 0.19, corresponding to 0.547 on the probability scale) suggests substantial heterogeneity in how strongly negative affect influences UCS.</p>
<p>The analysis of context evaluation showed a small but credible negative effect on UCS (mean = -0.04, 95% CI [-0.07, -0.01]), suggesting that higher context evaluation scores are associated with a slight reduction in UCS. The variability in individual responses (<code>sd(Intercept)</code> = 0.17, corresponding to 0.543 on the probability scale) also indicates substantial heterogeneity in the relationship between context evaluation and UCS across participants.</p>
<p>Finally, the interaction between CS and negative affect was negligible, with the 89% credible interval spanning zero (-0.03, 0.00), suggesting no meaningful interaction effect between these variables on UCS.</p>
</section>
<section id="discussion" class="level3">
<h3 class="anchored" data-anchor-id="discussion">Discussion</h3>
<p>Our idionomic analysis provides insight into the complex, momentary relationship between CS and UCS. Although the group-level results generally support Neff’s bipolar continuum hypothesis, substantial heterogeneity emerged in the strength and direction of the CS-UCS association across individuals. While most participants displayed the anticipated inverse relationship between CS and UCS, a notable proportion showed no clear association, and a smaller subset exhibited positive correlations—indicating that, for some individuals, CS and UCS may vary together rather than oppositely, which contradicts the bipolar continuum hypothesis [Ferrari et al., 2023; Ullrich et al., 2020]. This variability suggests that Neff’s hypothesis may not be universally applicable and underscores the importance of idiographic approaches in revealing the nuanced patterns often obscured in aggregate, group-level analyses.</p>
<p>Additionally, our analysis revealed that negative affect consistently increased UCS across participants, indicating that elevated negative emotional states tend to intensify uncompassionate self-responding. However, the variability observed across individuals highlights that the influence of negative affect on UCS is not uniform. Contrary to expectations, we found no credible evidence that negative affect moderated the CS-UCS relationship, suggesting that momentary emotional states do not substantially alter how CS influences UCS within individuals (Dejonckheere et al., 2021).</p>
</section>
</section>
<section id="idiographic-analysis" class="level2">
<h2 class="anchored" data-anchor-id="idiographic-analysis">Idiographic Analysis</h2>
<p>This section details the specification of the model fitted separately to individual data from both experiments, constituting the first step of our idiographic analysis.</p>
<section id="model-structure" class="level3">
<h3 class="anchored" data-anchor-id="model-structure">Model Structure</h3>
<p>We employed a hierarchical Bayesian model with the following characteristics:</p>
<ol type="1">
<li><strong>Response Variable</strong>: Uncompassionate Self-Responding (UCS).</li>
<li><strong>Primary Predictor</strong>: Compassionate Self-Responding (CS).</li>
<li><strong>Covariates</strong>:
<ul>
<li><code>neg_aff_Moment</code>: Momentary negative affect.</li>
<li><code>context_Moment</code>: Context evaluation.</li>
<li><code>lag_CS_same_day</code>: Lagged CS from the same day.</li>
</ul></li>
<li><strong>Distribution</strong>: Student’s t-distribution to account for potential outliers or heavy-tailed response distributions</li>
<li><strong>Temporal Dependency</strong>: Incorporated an AR(1) component to account for autoregressive effects of UCS.</li>
</ol>
</section>
<section id="model-parameters" class="level3">
<h3 class="anchored" data-anchor-id="model-parameters">Model Parameters</h3>
<ul>
<li><code>gamma_CS</code>: Coefficient representing the association between CS and UCS.</li>
<li><code>gamma_neg_aff</code>: Slope for negative affect (<code>neg_aff_Moment</code>).</li>
<li><code>gamma_context</code>: Slope for context evaluation (<code>context_Moment</code>).</li>
<li><code>phi</code>: Autoregressive coefficient for the lagged CS effect.</li>
<li><code>nu</code>: Degrees of freedom for the Student’s t-distribution (estimated by the model).</li>
<li><code>alpha</code>: Intercept term.</li>
<li><code>sigma</code>: Scale parameter of the Student’s t-distribution.</li>
</ul>
</section>
<section id="stan-model-specification" class="level3">
<h3 class="anchored" data-anchor-id="stan-model-specification">Stan Model Specification</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode stan code-with-copy"><code class="sourceCode stan"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">1</span>&gt; N;</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>[N] CS;</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>[N] UCS;</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>[N] neg_aff_Moment;</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>[N] context_Moment;</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>[N] lag_CS_same_day;</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="kw">parameters</span> {</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span> alpha_raw;</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span> gamma_CS_raw;</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span> gamma_neg_aff_raw;</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span> gamma_context_raw;</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span> phi_raw;</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; sigma;</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">2</span>&gt; nu;</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="kw">transformed parameters</span> {</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span> alpha = alpha_raw;</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span> gamma_CS = gamma_CS_raw;</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span> gamma_neg_aff = gamma_neg_aff_raw;</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span> gamma_context = gamma_context_raw;</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span> phi = phi_raw * <span class="fl">0.5</span>;  <span class="co">// Constraining phi to [-0.5, 0.5] for stability</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="kw">model</span> {</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Priors</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  alpha_raw ~ normal(<span class="dv">0</span>, <span class="dv">1</span>);</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  gamma_CS_raw ~ normal(<span class="dv">0</span>, <span class="dv">1</span>);</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  gamma_neg_aff_raw ~ normal(<span class="dv">0</span>, <span class="dv">1</span>);</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  gamma_context_raw ~ normal(<span class="dv">0</span>, <span class="dv">1</span>);</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  phi_raw ~ normal(<span class="dv">0</span>, <span class="dv">1</span>);</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  sigma ~ cauchy(<span class="dv">0</span>, <span class="fl">2.5</span>);</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  nu ~ gamma(<span class="dv">2</span>, <span class="fl">0.1</span>);</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Likelihood</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  UCS ~ student_t(nu, alpha + gamma_CS * CS + gamma_neg_aff * neg_aff_Moment + </span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>                  gamma_context * context_Moment + phi * lag_CS_same_day, sigma);</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This Stan code implements the hierarchical Bayesian model described above. The model uses weakly informative priors for all parameters and constrains the autoregressive coefficient <code>phi</code> to the interval [-0.5, 0.5] to ensure model stability. The degrees of freedom parameter <code>nu</code> is constrained to be greater than 2 to ensure finite variance of the Student’s t-distribution.</p>
</section>
</section>
<section id="hierarchical-model-analysis" class="level2">
<h2 class="anchored" data-anchor-id="hierarchical-model-analysis">Hierarchical Model Analysis</h2>
<p>In the second step of our idiographic analysis, we employed a hierarchical model approach, analogous to a meta-analysis <span class="citation" data-cites="ciarrochi2024compassion">[@ciarrochi2024compassion]</span>. This method allowed us to synthesize the individual-level results across all participants, providing both an aggregate estimate of the effects and a measure of heterogeneity among participants.</p>
<section id="model-specification" class="level3">
<h3 class="anchored" data-anchor-id="model-specification">Model Specification</h3>
<p>We fitted a hierarchical binomial model to the proportion of negative posterior draws for the <code>gamma_CS</code> parameter. In this framework, each participant was treated as a unique “study,” enabling us to estimate:</p>
<ol type="1">
<li>The aggregate proportion of negative effects across all participants.</li>
<li>The degree of heterogeneity in these effects among participants.</li>
</ol>
<p>The model was implemented using the <code>brms</code> package in R.</p>
</section>
<section id="r-code-for-model-fitting" class="level3">
<h3 class="anchored" data-anchor-id="r-code-for-model-fitting">R Code for Model Fitting</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>fit_gamma_cs_binom <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(n_negative <span class="sc">|</span> <span class="fu">trials</span>(n_total) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> id), <span class="at">family =</span> <span class="st">"binomial"</span>),</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> beta_cs_df,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sd"</span>)  </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">100000</span>, <span class="at">warmup =</span> <span class="dv">2000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>, <span class="at">max_treedepth =</span> <span class="dv">15</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="model-components" class="level3">
<h3 class="anchored" data-anchor-id="model-components">Model Components</h3>
<ul>
<li><p><strong>Formula</strong>: <code>n_negative | trials(n_total) ~ 1 + (1 | id)</code></p>
<ul>
<li><code>n_negative</code>: Count of negative posterior draws.</li>
<li><code>n_total</code>: Total number of posterior draws</li>
<li><code>(1 | id)</code>: Random intercept for each participant.</li>
</ul></li>
<li><p><strong>Family</strong>: Binomial, appropriate for modeling proportions.</p></li>
<li><p><strong>Priors</strong>:</p>
<ul>
<li><code>normal(0, 1)</code> for the intercept and standard deviation of random effects.</li>
<li>These priors are weakly informative, allowing the data to drive the results while providing some regularization.</li>
</ul></li>
<li><p><strong>MCMC Settings</strong>:</p>
<ul>
<li>100,000 iterations with 2,000 warmup.</li>
<li>4 chains run in parallel.</li>
<li>Increased <code>adapt_delta</code> and <code>max_treedepth</code> for improved MCMC convergence.</li>
</ul></li>
</ul>
</section>
<section id="extension-to-other-parameters" class="level3">
<h3 class="anchored" data-anchor-id="extension-to-other-parameters">Extension to Other Parameters</h3>
<p>We applied a similar hierarchical modeling approach to analyze the posterior distributions of other key parameters from the idiographic analyses:</p>
<ul>
<li><code>gamma_neg_aff</code>: Coefficient for negative affect.</li>
<li><code>gamma_context</code>: Coefficient for context evaluation.</li>
<li><code>gamma_interaction</code>: Coefficient for potential interaction effects.</li>
</ul>
</section>
</section>
<section id="posterior-predictive-checks" class="level2">
<h2 class="anchored" data-anchor-id="posterior-predictive-checks">Posterior Predictive Checks</h2>
<p>In the following sections, we present the results of the Posterior Predictive Checks for the four models used to assess the aggregate effects and heterogeneity in our idiographic analysis. These models evaluate the linear association between uncompassionate self-responding (UCS) and compassionate self-responding (CS), the effect of negative affect, the influence of contextual evaluation, and the interaction between CS and negative affect.</p>
<div id="fig-ppcheck_idiographic_gamma_cs" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="../../../../02_idiographic_test/plots/ppcheck_idiographic_gamma_cs.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: Idiographic analysis. Posterior Predictive Check for the hierarchical model fitted to the proportion of posterior draws of the <code>gamma_CS</code>parameter that were negative.</figcaption><p></p>
</figure>
</div>
<div id="fig-ppcheck_idiographic_gamma_neg_aff" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="../../../../02_idiographic_test/plots/ppcheck_idiographic_gamma_neg_aff.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;2: Idiographic analysis. Posterior Predictive Check for the hierarchical model fitted to the mean of the posterior draws of the <code>gamma_neg_aff</code> parameter.</figcaption><p></p>
</figure>
</div>
<div id="fig-ppcheck_idiographic_gamma_cs" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="../../../../02_idiographic_test/plots/ppcheck_idiographic_gamma_context.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3: Idiographic analysis. Posterior Predictive Check for the hierarchical model fitted to the mean of the posterior draws of the <code>gamma_context</code> parameter.</figcaption><p></p>
</figure>
</div>
<div id="fig-ppcheck_idiographic_gamma_cs" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="../../../../02_idiographic_test/plots/ppcheck_idiographic_gamma_interaction.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4: Idiographic analysis. Posterior Predictive Check for the hierarchical model fitted to the mean of the posterior draws of the <code>gamma_interaction</code> parameter.</figcaption><p></p>
</figure>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>