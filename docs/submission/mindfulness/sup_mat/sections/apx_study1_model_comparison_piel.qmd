
To evaluate the impact of contextual variables on state self-compassion, we developed two Bayesian hierarchical models, one for each dependent variable: UCS and CS. Both models shared identical fixed-effect and random-effect structures, with predictors including negative affect (person, day, moment) and context evaluation (person, day, moment). This approach allowed us to examine state self-compassion dynamics across individuals, days, and moments.

### Model Selection Process

A systematic model selection process was undertaken to identify the optimal random- and fixed-effect structures. Initially, we tested random-effect configurations ranging from simple participant-level clustering to more complex structures incorporating nested effects and random slopes. Using the Leave-One-Out Information Criterion (LOOIC) for model comparison, we identified that random intercepts for participants and days provided the best balance between model complexity and predictive accuracy.

For the fixed effects, we tested configurations that included all predictors (negative affect and context) at all levels (person, day, moment). The best-fitting model included all fixed effects, demonstrating superior predictive performance.

### Final Models

Both models included fixed effects for negative affect and context at the person, day, and moment levels, along with random intercepts for participants and days. 

### Model Diagnostics

We checked convergence using R-hat values, which were close to 1 for all parameters, indicating proper convergence. Posterior predictive checks demonstrated good model fit for both CS and UCS, with simulated data closely resembling observed data distributions.

### brms Code

The final models were specified as follows, using the `brms` package:

```r
# Model for UCS
model_ucs <- brm(
  bf(usc ~ na_moment + na_day + na_person + 
         context_moment + context_day + context_person +
         (1 | user_id) + (1 | user_id:day),
     sigma ~ 1),
  data = dataset,
  family = student(),
  chains = 4,
  cores = 8,
  iter = 4000,
  warmup = 1000,
  control = list(adapt_delta = 0.95, max_treedepth = 12),
  backend = "cmdstanr"
)

# Model for CS
model_cs <- brm(
  bf(cs ~ na_moment + na_day + na_person + 
         context_moment + context_day + context_person +
         (1 | user_id) + (1 | user_id:day),
     sigma ~ 1),
  data = dataset,
  family = student(),
  chains = 4,
  cores = 8,
  iter = 4000,
  warmup = 1000,
  control = list(adapt_delta = 0.95, max_treedepth = 12),
  backend = "cmdstanr"
)
```


